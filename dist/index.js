class S extends Map{obj(f){f&&O(f).forEach(([n,H])=>this.set(n,H))}map(f){f.forEach((n,H)=>{this.set(H,n)})}ass(f,n){if(!this.has(f))this.set(f,{});j(this.get(f),n)}}var Qf=(f)=>Array.from({length:f},(n,H)=>H),Bf="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Jf="abcdefghijklmnopqrstuvwxyz",Zf=Qf(10).join(""),Cf=new RegExp(/(\d+)(\d*)/,"m"),F=(f)=>typeof f==="function";var R=(f)=>{return!isNaN(parseFloat(f))&&isFinite(f)},x=(f)=>{return typeof f==="object"&&f!==null&&!Array.isArray(f)};var _=(f)=>typeof f==="boolean",V=(f)=>typeof f==="string",G=(f)=>Array.isArray(f),D=(f)=>typeof f==="object",m=(f)=>typeof f==="number";var{entries:O,hasOwn:yf}=Object;var j=Object.assign,u=(f)=>{return Object.keys(f).length};var k=(f)=>JSON.stringify(f);var t=(f)=>{if(f.startsWith("webkit"))f="--"+f;return f.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()};var X=(f)=>{let n=Bf+Jf;return Array.from({length:f},(H,E)=>n+(E?Zf:"")).reduce((H,E)=>{return H+=E.charAt(Math.floor(Math.random()*E.length))},"")};class c{e;opt;constructor(f){this.e=f;this.opt={duration:500,easing:"ease-in-out",fill:"forwards"}}animate(f,n={}){return this.e.animate(f,n)}get slide(){let f=({x:n=0,y:H=0},E={})=>{j(this.opt,E);let b=[[n,H],[0,0]].map(([g,Y])=>({transform:`translateX(${g}rem) translateY(${Y}rem)`}));return this.e.animate(b,this.opt),this};return{left:(n={})=>{return f({x:-2},n)},right:(n={})=>{return f({x:2},n)},up:(n={})=>{return f({y:2},n)},down:(n={})=>{return f({y:-2},n)}}}fade(f={}){j(this.opt,f);let n=[0,1].map((H)=>({opacity:H}));return this.e.animate(n,this.opt),this}shake(f="Y",n={}){j(this.opt,n);let H=[0,5,-5,5,0].map((E)=>({transform:`translate${f}(${E}px)`}));return this.e.animate(H,this.opt),this}color(f=[],n={}){j(this.opt,n);let H=Array.isArray(f)?f.map((E)=>({color:E})):{color:f};return this.e.animate(H,this.opt),this}bg(f=[],n={}){j(this.opt,n);let H=Array.isArray(f)?f.map((E)=>({backgroundColor:E})):{backgroundColor:f};return this.e.animate(H,this.opt),this}bounce(f=1,n={}){j(this.opt,n);let H=[0.5,f,1].map((E)=>({transform:`scale(${E})`}));return this.e.animate(H),this}}class p{e;query;constructor(f,n){this.e=f;this.query=n}get a(){return new c(this)}get all(){if(this.query){let f=document.querySelectorAll(this.query);if(f.length)return Array.from(f).map((n)=>L(n))}return[]}get attr(){let f=this.e;return{has:(n)=>{return f.hasAttribute(n)},get:(n)=>{return f.getAttribute(n)},del:(n)=>{return f.removeAttribute(n),this},set:(n)=>{for(let H in n){let E=n[H];if(n[H]!==void 0)f.setAttribute(H,E?E:"")}return this}}}get children(){return Array.from(this.e.children).map((f)=>L(f))}get click(){return this.e.click(),this}get delete(){return this.e.remove(),this}get disabled(){return this.e.disabled??!1}get focus(){return this.e.focus(),this}get id(){return this.e.id}get inner(){return this.e.innerHTML}get offsetParent(){let f=this.e.offsetParent;if(f)return new I(f);return}get parent(){let f=this.e.parentElement;if(f)return new I(f);return}get rect(){return this.e.getBoundingClientRect()}get remove_element(){return this.e.remove(),this}get style(){let f=this.e.style,n=this;return{set:(H,E=0)=>{let b=f,g=()=>{O(H).forEach(([Y,K])=>{if(Y in b){if(b[Y]!==K)b[Y]=K}else if(K!==null)f.setProperty(Y,String(K))})};if(F(E))n.on("transitionend",E);if(m(E))setTimeout(g,E);else g();return n},get:(H)=>{return f.getPropertyValue(H.toString())},del:(...H)=>{H.forEach((E)=>{f.removeProperty(E.toString())})}}}get submit(){let f=this.e;if("submit"in f)return f.submit();return!1}get tag(){return this.e.tagName.toLowerCase()}get value(){return this.e.value??""}set append(f){if(f instanceof o){let n=f.__();A(n.attr),this.e.insertAdjacentHTML("beforeend",n.ctx)}else this.e.insertAdjacentHTML("beforeend",f)}set appendfirst(f){if(f instanceof o){let n=f.__();A(n.attr),this.e.insertAdjacentHTML("afterbegin",n.ctx)}else this.e.insertAdjacentHTML("afterbegin",f)}set disabled(f){let n=this.e;if("disabled"in n)n.disabled=f}set inner(f){let n=f;if(f instanceof o){let H=f.__();A(H.attr),n=H.ctx}this.e.innerHTML=n}set id(f){this.e.id=f}set value(f){let n=this.e;n.value=f}}class I extends p{constructor(f,n){super(f,n)}add(...f){return this.e.classList.add(...f.map((n)=>n.replace(/[^\w-]/,""))),this}remove(...f){return this.e.classList.remove(...f.map((n)=>n.replace(/[^\w-]/,""))),this}toggle(f,n){let H=typeof f!="string"?f.apply(this):f,E=this.e.classList;return H.split(" ").forEach((b)=>{E.toggle(b,n)}),this}has(f){return this.e.contains(f)}insert(f){return{HTML:(...n)=>{return n.forEach((H)=>{this.e.insertAdjacentHTML(f,H)}),this},element:(...n)=>{return n.forEach((H)=>{this.e.insertAdjacentElement(f,H)}),this},text:function(...n){return n.forEach((H)=>{this.e.insertAdjacentText(f,H)}),this}}}is(f){let n=this.e.classList.value.split(" "),H=this.e.tagName.toLocaleLowerCase(),E=!0,b=!0;if(f.dom)b=f.dom==H?!0:!1;if(f.class)if(Array.isArray(f.class))f.class.forEach((g)=>{E=E?n.includes(g):!1});else E=E?n.includes(f.class):!1;return E&&b}on(f,n,H=!1){let E=!1;if(f.indexOf("touch")>-1)E=!0;return this.e.addEventListener(f,n,{capture:H,passive:E}),this}remove_on(f,n,H=!1){return this.e.removeEventListener(f,n,H),this}timed(f,n=250){return setTimeout(()=>f(this),n),this}animate(f,n,H){let E={duration:300,easing:"ease",fill:"forwards"};if(F(n))H=n;else j(E,n);let b=this.e.animate(f,E);if(H)b.finished.then(H);return this}}function L(f){if(V(f)){let n=document.querySelector(f);if(n)return new I(n,f);return}else return new I(f)}var $=new S,P=new S,i=new S;class z{_c=0;id="";constructor(f){if(this._c=0,this.id=f??X(5),f&&f.includes("_")){let n=f.split("_"),H=n.slice(-1).toString(),E=R(H);this.id=n.slice(0,-1).join("_"),this._c=E?parseInt(H):0}}get mid(){return this.id+"_"+ ++this._c}}var Lf=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],qf=(f)=>Lf.includes(f);function Gf(){let f=window,n=document,H=(E,b)=>{P.forEach((g,Y)=>{if(g[b]){let K=n.getElementById(Y);if(K)g[b].call(K,E.target);else P.delete(Y)}})};f.addEventListener("resize",(E)=>H(E,"resize")),f.addEventListener("beforeunload",(E)=>H(E,"unload")),f.addEventListener("popstate",(E)=>H(E,"popstate"))}function jf(f,n,H,E){let[b,g]=E,Y=b(H.e),K=H.id;if(K){let Q=new z(K),B=new S,[J,Z]=T(Y,B,Q);if(g!==J)return $.get(f).get(n)[1]=J,B.size&&A(B),H.inner=J,!0}return!1}function M(f,n=!1,H=!0){let E=document;if(!$.size)return;$f(E,n,H),Uf()}function $f(f,n,H){for(let[E,b]of $){if(!b.size){$.delete(E);continue}let g=f.getElementById(E);if(!g){$.delete(E);continue}let Y=L(g),K=n?"dom":"dom_ctx",Q=b.get(K);if(H&&Q&&jf(E,K,Y,Q)){M("doms",!1,!1);continue}Of(b,E,Y)}}function Of(f,n,H){for(let[E,b]of f){if(E==="dom"||E==="dom_ctx")continue;switch(E){case"ctx":Sf(n,H,b);break;case"on":Ff(n,H,b);break;case"style":of(n,H,b);break;default:zf(n,H,E,b)}}}function Sf(f,n,H){let[E,b]=H,g=new S,[Y]=T(E(n.e),g);if(b!==Y){n.inner=Y,g.size&&A(g);let K=$.get(f)?.get("ctx");if(K)K[1]=Y}}function Ff(f,n,H){$.get(f)?.delete("on"),O(H).forEach(([E,b])=>{if(!F(b))return;let g=b;if(E==="ready")b.apply(n.e);else if(["resize","unload","popstate"].includes(E))P.set(f,{[E]:g});else if(E==="watch"){let Y=b.apply(n.e);if(Y){let K=G(Y)?Y:[Y];K.length&&i.set(f,K)}}else n.on(E,g)})}function of(f,n,H){let E={};O(H).forEach(([b,g])=>{let[Y,K]=g,Q=Y(n.e);if(Q!==K)E[b]=Q,j($.get(f)?.get("style")??{},{[b]:[Y,Q]})}),u(E)&&n.style.set(E)}function zf(f,n,H,E){let[b,g]=E,Y=b(n.e);if(Array.isArray(Y))Y=Y.filter((K)=>K!="").join(" ");if(Y!=g)n.attr.set({[H]:Y}),$.get(f)?.set(H,[b,Y])}function Uf(){i.forEach((f)=>{f.forEach((n)=>{if("update"in n)n.update})})}var C=(f,n)=>{if(f instanceof o&&n)f.component=!1;else if(G(f))f.forEach((H)=>C(H,n))};function hf(f,n){if(typeof n==="object"&&G(n)&&!D(n[0]))return n.join("")===f.join("");return f===n}function A(f){f.size&&f.keys().forEach((n)=>{$.delete(n),i.delete(n),P.delete(n)}),$.map(f)}function U(f,n=!1){C(f,n);let H=f;return[()=>H,(Y)=>{if(hf(H,Y))return;C(Y,n),H=Y,M("state",n)},{}]}var Nf=(f,n,H=null)=>{if(!H)return;O(H).forEach((E)=>{r(E,f,n)})};function r(f,n,H){let[E,b]=f,g=E==="style";if(F(b)){let K=b();r([E,K],n,H),H.set(E,[b,K]);return}if(x(b)){Wf(E,b,g,n,H);return}let Y=(G(b)?b.flat():[b]).filter((K)=>K!==void 0).map((K)=>_(K)?K?"":"false":String(K)).join(" ");n.set(E,Y)}function Wf(f,n,H,E,b){if(H){let g=Af(n,b);E.set("style",g)}else if(f==="on")b.set(f,n)}function Af(f,n){return O(f).map(([H,E])=>{let b=t(H),g=E;if(F(E)){if(g=E(),!n.has("style"))n.set("style",{});j(n.get("style"),{[b]:[E,g]})}return`${b}:${g}`}).join(";")}var v=(f,n,H,E,b,g)=>{let Y=f.length,K=(Q,B)=>{if(B){let[J]=T(h("div",{},Q),H,b);n.push(J)}else{let J=Q(),Z=new z(g+"_0");g=Z.mid;let[q,gf,Yf]=T(J,H,Z),Kf=gf?Yf?"dom_ctx":"dom":"ctx";E.set(Kf,[Q,q]),n.push(q)}};return f.forEach((Q)=>{if(G(Q))v(Q,n,H,E,b,g);else if(F(Q))K(Q,Y>1);else{let[B]=T(Q,H,b);n.push(B)}}),g};function T(f,n,H=new z){let E=G(f)?f.flat():[f],b=!0,g=!1;return[E.map((K)=>{if(K instanceof o){g=!0,b=K.component;let Q=K.__(H);return n.map(Q.attr),Q.ctx}if(D(K))return JSON.stringify(K);return String(K===void 0?"":K)}).join(""),g,b]}class o{tag;_attr;component=!0;_ctx;constructor(f,n=null,...H){this.tag=f;this._attr=n;this._ctx=H}__(f=new z){let n=f.mid,H=new S,E=new S,b=new S,g=[];Nf(E,H,this._attr);let Y=v(this._ctx,g,b,H,f,n);if(H.size){let J=E.get("id")??Y;E.set("id",J),b.set(J,H)}let K=[""];E.forEach((J,Z)=>{K.push(J?`${Z}="${J}"`:Z)});let Q=this.tag,B=`<${Q}${K.join(" ")}>`;if(!qf(Q)){if(g.length)B+=g.join("");B+=`</${Q}>`}return{ctx:B,attr:b}}}function h(f,n=null,...H){if(typeof f==="function")return f(n??{},H);return new o(f,n,...H)}var If=(f,...n)=>n.flat();function y(f,n,H,E=!1){return f.forEach((b)=>{if(G(b))y(b,n,H,E);else if(b instanceof o){let g=b.__(n);if($.map(g.attr),E)H.push(g.ctx)}else if(E)H.push(b)}),H}class e{app;path="";constructor(f,n){this.app=f;this.path=n?n.replace(".tsx",".js"):""}async ctx(f={}){await this.dom(f,!0)}async dom(f={},n=!1){let H=L(document.body),E=H.id,b=[];if(!E)return;let g=new z(E+"_0"),Y=await this.app(f);if(n)H.inner="";let K=G(Y)?Y:[Y];if(y(K,g,b,n),n)H.appendfirst=b.join("");M("render"),Gf()}async ssr(f={}){let n=await this.app(f),H=X(5),E=new z(H+"_0"),b=G(n)?n:[n],g=[];return y(b,E,g,!0),{script:`<script type="module">import x from "./${this.path}";x.dom(${k(f)});</script>`,body:`<body id="${H}">${g.join("")}</body>`}}}class d{watchFn;value;handlers=[];constructor(f){this.watchFn=f;this.value=f()}on(f,n=!0){if(this.handlers.push(f),n)f(this.value);return this}get update(){let f=this.watchFn();if(this.value!==f)this.value=f,this.handlers.forEach((n)=>n(f));return}}var Tf=(f,n,H="url")=>{if(f.attr.get(H)==n)f.attr.set({slc:""});else f.attr.del("slc")};class N{static _parseURL(f){let n=[],H=[],E=f,b="",g=f.match(/(?<=\?)[^/].*=?(?=\/|$)/g);if(g?.[0])b=g?.[0],E=f.slice(0,f.indexOf(b)-1);let Y=E.match(/(?<=\/)[^/].*?(?=\/|$)/g)??["/"],K={};if(Y?.forEach((Q)=>{if(Q.indexOf("<")>=0){let B=Q.match(/(?<=<)[^/].*?(?=>|$)/g);if(B?.length){let J=B[0];if(J.indexOf(":")>-1){let[Z,q]=J.split(":");n.push(Z),H.push(q)}else n.push(J)}}else n.push(Q)}),f.slice(-1)=="/"&&f.length>1)n.push("/");if(b)decodeURIComponent(b).split("&").forEach((J)=>{let[Z,q]=J.split(/\=(.*)/,2);K[Z]=q});return{parsed:n,wcard:H,query:K}}static _type(f,n=!1){let H=[];if(R(f))H=[Number(f),"number"];else if(n&&f.indexOf(".")>=1)H=[f,"file"];else{let E="-";if(f.length==36){let b=f.match(/\-/g);if(b&&b.length==4)E="uuid";else E="string"}else if(f!="/")E="string";H=[f,E]}return H}}function Rf(f,n){let H=f[0],E=f.slice(1);switch(H){case"*":return n.includes(E);case"^":return n.startsWith(E);case"&":return n.endsWith(E);default:return!1}}class l{basePath;maps={};wild=[];pathname;constructor(f){this.basePath=f;this.pathname="pathname"in location?location?.pathname.slice(0,-1):""}push(f){let n=["string","number","uuid"],{parsed:H,wcard:E}=N._parseURL(f);if(E.length)this.wild.push(f);else for(let b=0;b<H.length;b++)if(n.includes(H[b])){this.wild.push(f);break}}match(f){let n=this.wild,{parsed:H}=N._parseURL(f),E="",b="",g=0,Y=0;if(H.forEach((K,Q)=>{for(let B=0;B<n.length;B++){let{parsed:J,wcard:Z}=N._parseURL(n[B]);if(J.length==H.length&&Z.length)if(K==J[Q]){b=n[B],g++;break}else if(Z[Y]){let q=Z[Y];if(Y++,Rf(q,K)){b=n[B],g++;break}}else{let q=N._type(K);if(J[Q]==q[1]){b=n[B],g++;break}}}}),!b||g!=H.length)H.forEach((K,Q)=>{for(let B=0;B<n.length;B++){let{parsed:J}=N._parseURL(n[B]);if(J.length==H.length)if(K==J[Q]){E=n[B];break}else{let[Z,q]=N._type(K);if(J[Q]==q){E=n[B];break}}}});return g==H.length?b:E}url(f){if(f in this.maps)return[f,!1];else{let n=this.match(f);if(n&&n in this.maps)return[n,!0]}return["",!1]}path(f,{file:n,title:H="",css:E=""}){let b=this.basePath;if(this.push(f),F(n))this.maps[f]={js:n,title:H,css:E};else{let g=this.pathname+(b?b+n:n);this.maps[f]={js:g.replaceAll("//","/"),title:H,css:E}}}}class a{map;pushState;url="";attr;isSheet;_page;_nav;_title;page;nav;title;e;constructor(f={}){[this.page,this._page]=U(h("div",void 0,""),!0),[this.nav,this._nav]=U("/"),[this.title,this._title]=U(""),this.pushState=f.pushState??!0,this.isSheet=f.isSheet??!1,this.attr=f.isSheet?"surl":"url",this.map=new l(f.basePath)}init(f,...n){this.e=f;let H=this.nav,E=this._nav,b=this.attr,g=(Y,K)=>{if(Y!==K)this.get(Y,K),E(Y);n.forEach((Q,B)=>{Q(this.isSheet&&B==0?!0:!1)})};return L(`[${b}]`)?.all.forEach((Y)=>{if(!Y.attr.has("nav"))Y.attr.set({nav:null}),Y.on("click",function(Q){Q.preventDefault();let B=L(this),J=B.attr.get(b);if(J)g(J,H())})}),this}afterImp(f,n,H,E=!1){if(this._title(n),this.init(this.e),!this.isSheet){if(location.pathname!==H)this.pushState&&history.pushState({},n,H);!E&&this.e&&this.e.scrollTo({top:f.sT,behavior:"instant"})}}async import(f,n,H=!1){let E=async(b)=>{this._page(await b()),this.afterImp(f,document.title,n)};if(V(f.js)){let b=await import((location.pathname?"":".")+f.js);if("default"in b){this._page(await b.default({...H&&{url:n}}));let g=f.title??document.title;!this.isSheet&&(document.title=g),this.afterImp(f,g,n)}else this._page(h("div",void 0,"error: js has no export defaults."))}else E(f.js)}sheet(f){let[n,H]=this.map.url(f);if(n)this.import(this.map.maps[n],f,H);return this}reset(){this._page(h("div",void 0,""))}async get(f,n){if(n){let[b,g]=this.map.url(n);if(b&&this.e)this.map.maps[b].sT=this.e.scrollTop??0}let[H,E]=this.map.url(f);if(H)this.url=f,this._nav(f),!this.isSheet&&L(`[${this.attr}]`)?.all.forEach((b)=>Tf(b,f)),await this.import(this.map.maps[H],f,E);else this._page(h("div",void 0,`"${f}" - not found...`));return this}path(f,{file:n,title:H="",css:E=""}){return this.map.path(f,{file:n,title:H,css:E}),this}}class ff{static isDark(...f){let[n,H]=U(!1),E=L(document.documentElement);if(this.isMatchMediaSupported)window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(b)=>{let Y=(b.matches?"dark":"light")==="dark";if(H(Y),Y)E.add(...f);else E.remove(...f)});return[n,H]}static get isMatchMediaSupported(){return window.matchMedia&&typeof window.matchMedia==="function"}}var s={},W={};class Hf{stream;url;constructor(f,n){if(this.url=f,f in s)this.stream=s[f];else this.stream=new EventSource(f,{withCredentials:n}),s[f]=this.stream,W[this.url]={}}on(f){let n=this.stream;return O(f).forEach(([H,E])=>{if(H in W[this.url])W[this.url][H].forEach((b)=>{this.stream.removeEventListener(H,b)}),W[this.url][H]=[];if(n.addEventListener(H,E),!(H in W[this.url]))W[this.url][H]=[];W[this.url][H].push(E)}),this}}function Zn(f,n=!0){return new Hf(f,n)}function nf(f){return!isNaN(parseFloat(f))&&isFinite(f)}class Ef{value;constructor(f){this.value=f}get str(){return String(this.value).toString()=="null"?null:String(this.value).toString()}get int(){if(nf(this.value))return parseInt(this.value);else return null}get float(){if(nf(this.value))return parseFloat(this.value);else return null}get bool(){if(this.value==="true")return!0;else if(this.value=="false")return!1;else return null}get json(){if(this.value)return JSON.parse(this.value);return null}}class w{key;func;storage;constructor(f,n="local"){if(typeof f=="object"){let[H,E]=O(f)[0];this.key=H,this.func=E}else this.key=f,this.func=null;this.storage=n=="local"?localStorage:sessionStorage}get as(){return new Ef(this.storage.getItem(this.key))}get value(){return this.storage.getItem(this.key)}get save(){if(this.func)this.set=this.func();return}set set(f){if(typeof f=="object")this.storage.setItem(this.key,JSON.stringify(f));else this.storage.setItem(this.key,String(f))}get remove(){this.storage.removeItem(this.key);return}}var Ln={get:(f)=>new w(f)},qn={get:(f)=>new w(f,"session")};class Vf{static set p(f){if(G(f))console.log(...f);else console.log(f)}static get isDark(){return window.matchMedia("(prefers-color-scheme: dark)").matches}}if(typeof window==="undefined")Object.assign(global,{window:{location:{pathname:""}},document:{querySelector:()=>({}),querySelectorAll:()=>({})},location:{location:{pathname:""}},localStorage:{},sessionStorage:{},navigator:{},history:{},screen:{},performance:{}});var Pf=new RegExp(/\/\/(.*?\w.*?$)/);function Df(f,n){let H=n;if(f){let E=Pf.exec(f);if(E?.length==2){let b=0;if(n.startsWith("..")){n.split("/").forEach((Q)=>{if(Q=="..")b+=1});let g=n.split("/").slice(b).join("/"),Y=E[1].split("/").slice(1,-1);H=Y.slice(0,Y.length-b).join("/")+"/"+g}else if(n.startsWith(".")){let g=n.split("/").slice(1).join("/");H=E[1].split("/").slice(1,-1).join("/")+"/"+g}}return"./"+H}return H}function bf(f){let n=document.querySelectorAll("head link");for(let H of n)if("rel"in H){if(H.href.indexOf(f.slice(1))>-1)return!0}return!1}async function Xf(f,n){if(Array.isArray(f)){for(let E of f)await Xf(E,n);return}let H=Df(n,f);if(bf(H))return;return new Promise((E,b)=>{let g=document.createElement("link");L(g).attr.set({id:"_css",rel:"preload stylesheet",type:"text/css",as:"style",href:H}),g.onload=()=>E(),g.onerror=()=>b(),L('script[type="module"]')?.insert("beforebegin").element(g)})}function Nn(f,n,H){if(bf(f))return f;let E=document.createElement("link");if(E.rel="preload",E.type=H,E.as=n,E.href=f,n==="font")E.crossOrigin="anonymous";return document.head.appendChild(E),f}export{U as state,qn as session,Nn as preload,Ln as local,Xf as loadCSS,If as frag,Zn as eventStream,h as dom,d as Watcher,ff as UI,a as Router,e as Render,o as Dom,Vf as $$,L as $};
